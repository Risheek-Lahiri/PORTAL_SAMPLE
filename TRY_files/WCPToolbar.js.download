var moveTracker={},updateAllowed=!1,contributeAllowed=!1;function focusOnMenuBar(a){a.getSource().focus()}function initToolbarHandle(a,b){updateAllowed=a;contributeAllowed=b;setTimeout(registerToolbarHandle,500);window.addEventListener("load",registerToolbarHandle,!1)}function registerToolbarHandle(){var a=["pthnd1","pthnd2"],b;for(b in a){var c=document.getElementById(a[b]);null!=c&&registerMoveListener(c)}registerControlListeners()}
function registerMoveListener(a){AdfAgent.AGENT.getCapabilities()[AdfAgent.CAP_TOUCH_SCREEN]!=AdfAgent.CAP_TOUCH_SCREEN_NONE?(a.addEventListener("touchstart",beginMoveToolbar),a.addEventListener("mousedown",beginMoveToolbar),a.moveListeners={mousemove:moveToolbar,mouseup:endMoveToolbar,mouseout:outMoveToolbar,touchmove:moveToolbar,touchend:endMoveToolbar,touchcancel:endMoveToolbar}):(a.addEventListener("mousedown",beginMoveToolbar),a.moveListeners={mousemove:moveToolbar,mouseup:endMoveToolbar,mouseout:outMoveToolbar});
registerMoveTrackerToolbar(a)}function registerControlListeners(){document.addEventListener("keydown",handleControlKeys,!1)}function registerMoveTrackerToolbar(a){for(;!a.className.match(/(?:^|\s)WCPToolbar(?!\S)/);)a=a.parentNode;moveTracker.toolbar=a}
function handleControlKeys(a){if(a.ctrlKey&&a.shiftKey){var b=AdfPage.PAGE.findComponent(moveTracker.toolbar.id);updateAllowed&&"69"==a.keyCode&&(a.preventDefault(),AdfCustomEvent.queue(b,"toggleEdit",null,!0));contributeAllowed&&"67"==a.keyCode&&(b.focus(),a.preventDefault(),AdfCustomEvent.queue(b,"toggleContribute",null,!0))}}
function beginMoveToolbar(a){var b=a.currentTarget;moveTracker.handle=b;registerMoveTrackerToolbar(b);moveTracker.position=AdfAgent.AGENT.getMousePosition(a);for(var c in moveTracker.handle.moveListeners)document.addEventListener(c,moveTracker.handle.moveListeners[c])}function outMoveToolbar(a){var b=a.relatedTarget||a.toElement;b&&"HTML"!=b.nodeName.toUpperCase()||endMoveToolbar(a)}
function endMoveToolbar(a){for(var b in moveTracker.handle.moveListeners)document.removeEventListener(b,moveTracker.handle.moveListeners[b]);AdfCustomEvent.queue(AdfPage.PAGE.findComponent(moveTracker.toolbar.id),"endMoveToolbar",{right:parseInt(moveTracker.toolbar.style.right),top:parseInt(moveTracker.toolbar.style.top)},!1);moveTracker={}}
function moveToolbar(a){if(moveTracker.toolbar){var b=AdfAgent.AGENT.getMousePosition(a),c=b.x-moveTracker.position.x,d=b.y-moveTracker.position.y;moveTracker.position=b;moveTracker.toolbar.style.right=parseInt(moveTracker.toolbar.style.right)-c+"px";moveTracker.toolbar.style.top=parseInt(moveTracker.toolbar.style.top)+d+"px";a.preventDefault()}}function saveSandbox(a){AdfCustomEvent.queue(a.getSource(),"saveSandbox",null,!0)};